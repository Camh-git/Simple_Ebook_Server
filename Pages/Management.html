<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="../Assets/StyleSheet.css" />
    <link rel="icon" href="../Assets/Images/favicon.ico" />
  </head>
  <div id="header_container"></div>
  <body>
    <div id="Management_pannel">
      <h1>Management</h1>

      <section id="Req_status_modal">
        <div id="Req_status_modal_body">
          <p>Click anywhere in the background to close this popup</p>
        </div>
      </section>

      <ul id="Row_list">
        <li>
          <h2>Manage individual books</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle book management"
          />
          <section class="Management-row">
            <!--upload single, todo:Add a folder select-->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="US_form"
              action="../Assets/Scripts/Upload_single.php"
            >
              <h3>Upload book</h3>
              <input
                type="file"
                name="US_file_inp"
                accept=".epub,.pdf,.txt,.doc,.docx"
              />
              <br />
              <input type="submit" value="upload" />
              <p class="Warning">Max upload size: 30MB</p>
            </form>

            <!--Delete single-->
            <form method="POST" enctype="multipart/form-data" id="DS_form">
              <h3>Delete book</h3>
              <label for="DS_folder_select">Select folder</label>
              <select name="DS_folder_select" id="DS_folder_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <label for="DS_book_select">Select book</label>
              <select name="DS_book_select" id="DS_book_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <input type="submit" value="Submit" />
            </form>

            <!--Rename single-->
            <form method="POST" enctype="multipart/form-data" id="RS_form">
              <h3>Rename book</h3>
              <label for="RS_folder_select">Select folder</label>
              <select name="RS_folder_select" id="RS_folder_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <label for="RS_book_select">Select book</label>
              <select name="RS_book_select" id="RS_book_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <input type="text" name="RS_New_name" placeholder="New name" />
              <br />
              <input type="submit" value="Submit" />
            </form>
          </section>
        </li>

        <li>
          <h2>Manage folders</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle book management"
          />
          <section class="Management-row">
            <!--Upload folder -->
            <form
              method="POST"
              enctype="multipart/form-data"
              action="../Assets/Scripts/Upload_folder.php"
            >
              <h3>Upload folder</h3>
              <input type="text" name="UF_name" placeholder="name" />
              <p>
                Please add each file you want to upload(if none please use
                create folder)
              </p>
              <input
                type="file"
                name="UF_inp_Files[]"
                multiple="multiple"
                accept=".epub,.pdf,.txt,.doc,.docx"
              />
              <br />
              <input type="submit" value="upload" />
            </form>

            <!--Delete folder-->
            <form method="POST" enctype="multipart/form-data" id="DF_form">
              <h3>Delete folder</h3>

              <select name="DF_folder_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <input type="submit" value="Submit" />
              <br />
              <input
                type="checkbox"
                name="DS_Delete_content"
                id="DS_Delete_content"
                value="DS_Delete_content"
              />
              <label for="DS_Delete_content" class="alwaysShow"
                >Delete folder content?(Content will be moved to misc if not
                checked)</label
              >
            </form>

            <!--Rename folder-->
            <form method="POST" enctype="multipart/form-data" id="RF_form">
              <h3>Rename folder</h3>

              <select name="RF_folder_select">
                <option value="None">No selection</option>
              </select>

              <input type="text" name="RF_New_name" placeholder="New name" />
              <br />
              <input type="submit" value="Submit" />
            </form>
          </section>
        </li>

        <!--Manage library-->
        <li>
          <h2>Manage library</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle book management"
          />
          <section class="Management-row">
            <!--Create empty folder -->
            <form method="POST" enctype="multipart/form-data" id="CF_form">
              <h3>Create new folder</h3>
              <input type="text" name="CF_Name" placeholder="Enter name here" />
              <br />
              <input type="submit" value="Submit" />
            </form>

            <!--Move book between folders-->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="MV_folder_form"
            >
              <h3>Move book to new folder</h3>

              <label for="MV_folder_select">Select current folder</label>
              <select id="MV_folder_select" name="MV_folder_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <label for="MV_book_select">Select book</label>
              <select id="MV_book_select" name="MV_book_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <!--NOTE: This naming inconsistency is intentional, it prevents the book select from changing when a new target is chosen -->
              <label for="mv_target_folder_select">Select new folder</label>
              <select
                id="mv_target_folder_select"
                name="mv_target_folder_select"
              >
                <option value="None">No selection</option>
              </select>
              <br />
              <input type="submit" value="Submit" />
            </form>
          </section>
        </li>

        <li>
          <h2>Manage thumbnails</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle book management"
          />
          <section class="Management-row">
            <!--Re-assign thumbnails-->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="TH_select_form"
            >
              <h3>Re-assign Thumbnails</h3>

              <label for="TH_folder_select">Folder</label>
              <select name="TH_folder_select" id="TH_folder_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <label for="TH_book_select">Book</label>
              <select name="TH_book_select" id="TH_book_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <label for="TH_new_select">Select new image.</label>
              <select name="TH_select" id="TH_new_select">
                <option value="None">No selection</option>
              </select>
              <br />
              <br />

              <input type="submit" value="Change" />
            </form>

            <!--Upload thumbnail -->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="TH_upload_form"
              action="../Assets/Scripts/Upload_thumb.php"
            >
              <h3>Upload a thumbnail</h3>
              <input
                type="file"
                name="New_thumb_inp"
                accept=".png,.jpg,.jpeg,.svg,.gif,.webp,.xcf,.psd"
              />
              <br />
              <input type="submit" value="Upload" />
            </form>

            <!--Rename thumbnails-->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="TH_rename_form"
            >
              <h3>Rename Thumbnail</h3>

              <label for="TH_rn_select">Select new image.</label>
              <select name="TH_select" id="TH_rn_select">
                <option value="None">No selection</option>
              </select>
              <br />
              <br />
              <input type="text" name="TH_rn_new_name" placeholder="New name" />

              <input type="submit" value="Change" />
            </form>

            <!--Format thumbnail cache-->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="TH_format_form"
            >
              <h3>Delete/populate thumbnail cache</h3>
              <p>
                Clearing the cache will remove all thumbnails, they will be
                re-generated when you next visit the libary page.
              </p>
              <p>
                Re-populate will automaticaly empty and then refill the folder
              </p>

              <label for="Thumb_regen" class="alwaysShow"
                >Repopulate cache</label
              >
              <input
                type="checkbox"
                name="Thumb_cache_format"
                id="Thumb_regen"
                checked="True"
              />
              <br />

              <label for="Thumb_rm_manual" class="alwaysShow"
                >Remove manual additions</label
              >
              <input
                type="checkbox"
                name="Thumb_cache_format"
                id="Thumb_rm_manual"
              />
              <br />

              <input type="submit" value="Start" />
              <h3 class="Warning">WARNING: This action removes files.</h3>
            </form>

            <!--Delete thumbnail-->
            <form method="POST" enctype="multipart/form-data" id="TH_del_form">
              <h3>Delete thumbnail</h3>

              <label for="TH_rm_select">Select Tuhumb to delete.</label>
              <br />
              <select name="TH_select" id="TH_rm_select">
                <option value="None">No selection</option>
              </select>
              <br />
              <br />
              <input type="submit" value="Submit" />
            </form>
          </section>
        </li>

        <!--Manage book data-->
        <li>
          <h2>Manage book data</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle book data management"
          />
          <section class="Management-row">
            <!--Re-generate book data-->
            <form method="POST" enctype="multipart/form-data" id="GBD_form">
              <h3>Generate book data</h3>
              <p>
                Use the bellow button to re-generate book data (This will take
                some time)This function will not update data that has been
                flagged as verified.
              </p>
              <p>
                This function will go through all the folders in the library and
                add data for each book using the google books api.
              </p>

              <h3>Data format</h3>
              <table>
                <tr>
                  <th>Entry</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td>Title</td>
                  <td>To edit this use the rename book form</td>
                </tr>
                <tr>
                  <td>Authors</td>
                  <td>Add one by one, seperated by a comma</td>
                </tr>
                <tr>
                  <td>Date</td>
                  <td>The publication date, formatted: yyyy-mm-dd</td>
                </tr>
                <tr>
                  <td>ISBN 10</td>
                  <td>The book's 10 digit ISBN code</td>
                </tr>
                <tr>
                  <td>ISBN 13</td>
                  <td>The book's 13 digit ISBN code</td>
                </tr>
                <tr>
                  <td>Thumbnail URL</td>
                  <td>The web URL the thumbnail came from</td>
                </tr>
              </table>

              <h3 class="Warning">
                Note: This funtion may take up to 30 seconds and will edit data
              </h3>
              <input type="submit" value="Apply" />
            </form>
            <!-- Edit book data-->
            <form method="POST" enctype="multipart/form-data" id="EBD_form">
              <h3>Edit book data</h3>
              <p>
                Please select a book and update it as needed. seperate each
                author with a comma.
              </p>
              <!--Select books-->
              <label for="BD_folder_select">Select folder</label>
              <select name="BD_folder_select" id="BD_folder_select">
                <option value="None">No selection</option>
              </select>
              <br />
              <label for="BD_book_select">Select book</label>
              <select name="BD_book_select" id="BD_book_select">
                <option value="None">No selection</option>
              </select>
              <br />

              <!--Book data-->
              <label for="EDB_Authors">Authors, seprated by ,:</label>
              <input type="text" name="EDB_Authors" placeholder="Authors" />
              <label for="EDB_date">Publication date:</label>
              <input type="text" name="EDB_date" placeholder="yyyy-mm-dd" />
              <br />
              <label for="EDB_pub">Publisher:</label>
              <input type="text" name="EDB_pub" placeholder="Publisher" />
              <br />
              <label for="EDB_ISBN">ISBN 10:</label>
              <input type="text" name="EDB_ISNB" placeholder="ISBN 10" />
              <br />
              <label for="EDB_ISBN13">ISBN 13:</label>
              <input type="text" name="EDB_ISNB13" placeholder="ISBN 13" />
              <br />
              <label for="EDB_thumb">Thumnail url:</label>
              <input type="text" name="EDB_thumb" placeholder="Thumbnail" />
              <br />
              <label for="EDB_valid"
                >Validated (will ignore data generator):</label
              >
              <input
                type="checkbox"
                name="EDB_valid"
                id="EDB_valid"
                value="EDB_valid"
              />
              <br /><br />
              <input type="submit" value="submit" />
            </form>
          </section>
        </li>

        <!--Misc options-->
        <li>
          <h2>Misc options</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle misc options"
          />
          <section class="Management-row">
            <!--Enable or disable downloads-->
            <form
              method="POST"
              enctype="multipart/form-data"
              id="DL_toggle_form"
            >
              <h3>Enable downloads?</h3>

              <p name="Downloads enabled display">Downloads should be:</p>
              <label for="DL_toggle_enable" class="alwaysShow">Enabled</label>
              <input
                type="Radio"
                name="DL_toggle"
                id="DL_toggle_enable"
                value="True"
              />
              <label for="DL_toggle_disable" class="alwaysShow">Disabled</label>
              <input
                type="Radio"
                name="DL_toggle"
                id="DL_toggle_disable"
                value="False"
              />
              <br />

              <input
                type="password"
                name="DL_toggle_PW"
                placeholder="Password"
              />
              <input type="submit" value="Apply" />

              <h3 class="Warning">
                Note: This function is solely for personal use, do not enable if
                server is shared
              </h3>
            </form>

            <!--Enable or disable online readers-->
            <form method="POST" enctype="multipart/form-data" id="TOGR_form">
              <h3>Enable online readers?</h3>
              <p name="Downloads enabled display">Readers should be:</p>
              <label for="TOGR_toggle_enable" class="alwaysShow">Enabled</label>
              <input
                type="Radio"
                name="Reader_toggle"
                id="TOGR_toggle_enable"
                value="True"
              />
              <label for="TOGR_toggle_disable" class="alwaysShow"
                >Disabled</label
              >
              <input
                type="Radio"
                name="Reader_toggle"
                id="TOGR_toggle_disable"
                value="False"
              />
              <br />
              <input
                type="password"
                name="TOGR_toggle_PW"
                placeholder="Password"
              />
              <input type="submit" value="Apply" />
            </form>

            <!--Add an IP to either the black or white list-->
            <form method="POST" enctype="multipart/form-data" id="IP_form">
              <h3>Manage IP lists</h3>
              <p>Please select a list and enter an IP to add.</p>
              <label for="IP_Whitelist" class="alwaysShow">Whitelist</label>
              <input
                type="Radio"
                name="IP_list_choice"
                id="IP_Whitelist"
                value="Whitelist"
              />
              <label for="IP_Blacklist" class="alwaysShow">Blacklist</label>
              <input
                type="Radio"
                name="IP_list_choice"
                id="IP_Blacklist"
                value="Blacklist"
              />
              <br />

              <input
                type="text"
                name="IP_list_add_Target"
                placeholder="0.0.0.0"
              />
              <input
                type="password"
                name="IP_list_code"
                placeholder="Password"
              />
              <br />

              <label for="IP_list_add" class="alwaysShow">Add</label>
              <input
                type="Radio"
                name="IP_list_add_or_rm"
                id="IP_list_add"
                value="ADD"
              />
              <label for="IP_list_rm" class="alwaysShow">Remove</label>
              <input
                type="Radio"
                name="IP_list_add_or_rm"
                id="IP_list_rm"
                value="REMOVE"
              />
              <br />

              <input type="submit" value="Change" />
            </form>

            <form method="POST" enctype="multipart/form-data" id="IPR_form">
              <h3>IP restrictions</h3>
              <p>Activate the whitelist, blacklist or neither</p>
              <label for="IPR_Whitelist" class="alwaysShow">Whitelist</label>
              <input
                type="Radio"
                name="IPR_list_choice"
                id="IPR_Whitelist"
                value="Whitelist"
              />
              <br />
              <label for="IPR_Blacklist" class="alwaysShow">Blacklist</label>
              <input
                type="Radio"
                name="IPR_list_choice"
                id="IPR_Blacklist"
                value="Blacklist"
              />
              <br />
              <label for="IPR_None" class="alwaysShow">None</label>
              <input
                type="Radio"
                name="IPR_list_choice"
                id="IPR_None"
                value="None"
              />

              <br />
              <input
                type="password"
                name="IPR_list_code"
                placeholder="Password"
              />
              <br />

              <input type="submit" value="Change" />
            </form>
          </section>
        </li>

        <li>
          <h2>Management options</h2>
          <image
            src="../Assets/Images/expand_more_white_24dp.svg"
            alt="Toggle book management"
          />
          <section class="Management-row">
            <!-- Main enable or disable of all management forms -->
            <form method="POST" enctype="multipart/form-data" id="MNT_form">
              <h3>Enable management</h3>
              <p>Select if the remote management tools can be used or not</p>
              <label for="MNT_list_choice_true" class="alwaysShow">
                Enable
              </label>
              <input
                type="Radio"
                name="MNT_toggle"
                id="MNT_list_choice_true"
                value="True"
              />
              <br />
              <label for="MNT_list_choice_false" class="alwaysShow"
                >Disable</label
              >
              <input
                type="Radio"
                name="MNT_toggle"
                id="MNT_list_choice_false"
                value="False"
              />

              <br />
              <input type="password" name="MNT_code" placeholder="Password" />
              <br />
              <input type="submit" value="Change" />
            </form>

            <!-- Disable or enable upload forms -->
            <form method="POST" enctype="multipart/form-data" id="MNU_form">
              <h3>Enable Upload</h3>
              <p>Select if the Upload forms can be used</p>
              <label for="MNU_list_choice_true" class="alwaysShow">
                Enable
              </label>
              <input
                type="Radio"
                name="MNU_toggle"
                id="MNU_list_choice_true"
                value="True"
              />
              <br />
              <label for="MNU_list_choice_false" class="alwaysShow"
                >Disable</label
              >
              <input
                type="Radio"
                name="MNU_toggle"
                id="MNU_list_choice_false"
                value="False"
              />

              <br />
              <input type="password" name="MNU_code" placeholder="Password" />
              <br />
              <input type="submit" value="Change" />
            </form>

            <!-- Disable or enable delete forms -->
            <form method="POST" enctype="multipart/form-data" id="MND_form">
              <h3>Enable Delete</h3>
              <p>Select if the delete forms can be used</p>
              <label for="MND_list_choice_true" class="alwaysShow">
                Enable
              </label>
              <input
                type="Radio"
                name="MND_toggle"
                id="MND_list_choice_true"
                value="True"
              />
              <br />
              <label for="MND_list_choice_false" class="alwaysShow"
                >Disable</label
              >
              <input
                type="Radio"
                name="MND_toggle"
                id="MND_list_choice_false"
                value="False"
              />

              <br />
              <input type="password" name="MND_code" placeholder="Password" />
              <br />
              <input type="submit" value="Change" />
            </form>

            <!-- Disable or enable rename forms -->
            <form method="POST" enctype="multipart/form-data" id="MNR_form">
              <h3>Enable rename</h3>
              <p>Select if the rename forms can be used</p>
              <label for="MNR_list_choice_true" class="alwaysShow">
                Enable
              </label>
              <input
                type="Radio"
                name="MNR_toggle"
                id="MNR_list_choice_true"
                value="True"
              />
              <br />
              <label for="MNR_list_choice_false" class="alwaysShow"
                >Disable</label
              >
              <input
                type="Radio"
                name="MNR_toggle"
                id="MNR_list_choice_false"
                value="False"
              />

              <br />
              <input type="password" name="MNR_code" placeholder="Password" />
              <br />
              <input type="submit" value="Change" />
            </form>

            <!-- Disable or enable move forms -->
            <form method="POST" enctype="multipart/form-data" id="MNM_form">
              <h3>Enable Move</h3>
              <p>Select if the move book/thumb forms can be used</p>
              <label for="MNM_list_choice_true" class="alwaysShow">
                Enable
              </label>
              <input
                type="Radio"
                name="MNM_toggle"
                id="MNM_list_choice_true"
                value="True"
              />
              <br />
              <label for="MNM_list_choice_false" class="alwaysShow"
                >Disable</label
              >
              <input
                type="Radio"
                name="MNM_toggle"
                id="MNM_list_choice_false"
                value="False"
              />

              <br />
              <input type="password" name="MNM_code" placeholder="Password" />
              <br />
              <input type="submit" value="Change" />
            </form>
          </section>
        </li>
      </ul>
    </div>
  </body>

  <div id="footer_container"></div>
  <script type="module">
    //Placeholder copied from Append_management_rows.js used here until the bugs in that script are sorted out
    let Rows = document.getElementById("Row_list").children;
    for (let group of Rows) {
      group
        .getElementsByTagName("img")[0]
        .addEventListener("click", function (e) {
          toggle_forms(e);
        });
      group
        .getElementsByTagName("h2")[0]
        .addEventListener("click", function (e) {
          toggle_forms(e);
        });

      function toggle_forms(e) {
        let section = e.target.parentNode.getElementsByTagName("section")[0];
        let image = e.target.parentNode.getElementsByTagName("img")[0];
        if (section.style.display == "flex") {
          section.style.display = "none";
          image.src = "../Assets/Images/expand_more_white_24dp.svg";
        } else {
          section.style.display = "flex";
          image.src = "../Assets/Images/expand_less_white_24dp.svg";
        }
      }
    }
  </script>
  <script src="../Assets/Scripts/Append_H&F.js"></script>
  <script
    type="module"
    src="../Assets/Scripts/Populate_management_selects.js"
  ></script>
  <script
    type="module"
    src="../Assets/Scripts/Set_management_listeners.js"
  ></script>
  <script type="module" src="../Assets/Scripts/Server_IP.js"></script>
</html>
